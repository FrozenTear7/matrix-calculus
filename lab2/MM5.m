function [X] = MM5(A, B)
  if abs(A(2, 1)) > abs(A(1, 1)) && abs(A(2, 1)) > abs(A(3, 1))
    A([2 1], :) = A([1 2], :)
    B([2 1]) = B([1 2])
  elseif abs(A(3, 1)) > abs(A(1, 1)) && abs(A(3, 1)) > abs(A(2, 1))
    A([3 1], :) = A([1 3], :)
    B([3 1]) = B([1 3])
  endif
  
  tmp = A(2, 1) / A(1, 1)
  
  B = [
    B(1, 1)
    B(2, 1) - B(1) * tmp
    B(3, 1)
  ]
  
  A = [
    A(1, 1) A(1, 2)                 A(1, 3)
    0       A(2, 2) - A(1, 2) * tmp A(2, 3) - A(1, 3) * tmp
    0       A(3, 2)                 A(3, 3)
  ]
    
  if abs(A(3, 2)) > abs(A(2, 2))
    A([3 2], :) = A([2 3], :)
    B([3 2]) = B([2 3])
  endif
  
  tmp = A(3, 2) / A(2, 2)
  
  B = [
    B(1, 1)
    B(2, 1)
    B(3, 1) - B(2, 1) * tmp
  ]
  
  A = [
    A(1, 1) A(1, 2) A(1, 3)
    A(2, 1) A(2, 2) A(2, 3)
    A(3, 1) 0       A(3, 3) - A(2, 3) * tmp
  ]
  
  X3 = B(3, 1) / A(3, 3)
  X2 = (B(2, 1) - A(2, 3) * X3) / A(2, 2)
  X1 = (B(1, 1) - A(1, 2) * X2 - A(1, 3) * X3) / A(1, 1)
  
  X = [X1, X2, X3]
endfunction